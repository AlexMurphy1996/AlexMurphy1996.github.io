<!DOCTYPE html>
<html>
<head>
  <title>LP â†’ Orchestrate Widget</title>
</head>
<body>
  <h3>Watsonx Orchestrate Connector</h3>
  <div id="log" style="font-family: monospace; white-space: pre-wrap; max-height: 300px; overflow-y: auto; border: 1px solid #ccc; padding: 10px;"></div>

  <script>
    (async () => {

      // Initialize LP Agent SDK
      lpTag.agentSDK.init({});
      const sdk = lpTag.agentSDK;
      const log = (msg) => {
        const logDiv = document.getElementById("log");
        logDiv.textContent += msg + "\n";
        logDiv.scrollTop = logDiv.scrollHeight;
      };

      log("Agent SDK initialized âœ…");

      // Example: subscribe to chat lines
      const onLine = (data) => {
        try {
          const text = data.newValue?.text;
          const role = data.newValue?.source;
          if (role === "visitor" && text) {
            log(`[Customer] ${text}`);
            // ðŸ‘‰ here is where youâ€™d call Orchestrate API
          }
        } catch (e) {
          log("Error parsing message: " + e);
        }
      };

      sdk.bind("chatTranscript.lines", onLine, (err) => {
        if (err) log("Bind error: " + err);
        else log("Bound to chatTranscript.lines");
      });
    })();
  </script>
</body>
</html>
